<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>AI Wedding Dashboard | Smart Shaadi</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #ffcc33; --dark: #0f0f1a; --cyan: #00f2ff; --glass: rgba(255, 255, 255, 0.05); }
        body { font-family: 'Inter', sans-serif; background: var(--dark); color: white; text-align: center; }
        .db-card { max-width: 600px; margin: 50px auto; padding: 30px; border: 2px solid var(--cyan); border-radius: 20px; background: #0a0a14; box-shadow: 0 0 20px rgba(0, 242, 255, 0.2); }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .item { background: var(--glass); padding: 15px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); }
        .label { color: var(--cyan); font-size: 0.7rem; font-family: 'Orbitron'; text-transform: uppercase; }
        .value { font-size: 1.1rem; font-weight: bold; margin-top: 5px; }
        .loader { color: var(--gold); font-family: 'Orbitron'; margin: 20px; }
    </style>
</head>
<body>

<div class="db-card">
    <h2 style="font-family:'Orbitron'; color:var(--gold);">LIVE <span style="color:white">DASHBOARD</span></h2>
    <div id="loading" class="loader">FETCHING DATA FROM GOOGLE SHEETS...</div>
    
    <div id="content" style="display:none;">
        <p>Welcome, <span id="user-name" style="color:var(--cyan)">Explorer</span>!</p>
        <div class="grid">
            <div class="item"><div class="label">Wedding Date</div><div id="val-date" class="value">--</div></div>
            <div class="item"><div class="label">City</div><div id="val-city" class="value">--</div></div>
            <div class="item"><div class="label">Total Budget</div><div id="val-total" class="value" style="color:var(--gold)">₹0</div></div>
            <div class="item"><div class="label">Guests</div><div id="val-guests" class="value">--</div></div>
        </div>
        
        <div style="background:rgba(255,204,51,0.1); padding:15px; border-radius:10px; border:1px dashed var(--gold);">
            <p style="font-size:0.8rem; margin:0;">AI Advice: <span id="ai-tip">Planning your dream wedding...</span></p>
        </div>

        <button onclick="window.open('https://care-123.app.n8n.cloud/webhook/a3b79b62-1b23-4077-9856-02b84a40527b/chat')" 
                style="margin-top:20px; width:100%; padding:15px; background:var(--gold); border:none; border-radius:10px; font-family:'Orbitron'; font-weight:bold; cursor:pointer;">
            CHAT WITH AI BOT ✨
        </button>
    </div>
</div>

<script>
    async function fetchLatestData() {
        const sheetId = '1ekr04BWhy6zRWDadcFXA_ZujmkeGKe7hMdO6FBDyA7Y';
        const base = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=Wedding_Submissions`;
        
        try {
            const res = await fetch(base);
            const text = await res.text();
            const json = JSON.parse(text.substr(47).slice(0, -2));
            const rows = json.table.rows;
            const latest = rows[rows.length - 1].c; // Sabse niche wali row

            // Mapping (Columns ke hisab se)
            document.getElementById('user-name').innerText = latest[0].v; // Couple Names
            document.getElementById('val-date').innerText = latest[1].v; // Date
            document.getElementById('val-total').innerText = "₹" + parseInt(latest[2].v).toLocaleString(); // Budget
            document.getElementById('val-guests').innerText = latest[3].v; // Guests
            document.getElementById('val-city').innerText = latest[4].v; // City/Venue Type

            document.getElementById('loading').style.display = 'none';
            document.getElementById('content').style.display = 'block';
        } catch (e) {
            document.getElementById('loading').innerText = "Error: Please make sure the sheet is public!";
        }
    }
    window.onload = fetchLatestData;
</script>
</body>
</html>
